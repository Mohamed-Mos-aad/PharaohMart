import{h as g,i as f,r as d,j as s,l as w}from"./index-B0bwO9iM.js";import{S as y}from"./SwitchAuth-BV9Obngc.js";import{I as m}from"./InputElement-DsxyK5o1.js";import{a as E}from"./index-CR4Xcdnb.js";const j="_auth_form_17roa_3",x={auth_form:j},I="http://localhost:1337",b=async o=>{try{const a=await fetch(`${I}/api/auth/local/`,{method:"Post",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifier:o?.userEmail,password:o?.userPassword})}),e=await a.json();return a.ok&&e.jwt?(localStorage.setItem("token",e.jwt),localStorage.setItem("userData",JSON.stringify(e.user)),e):(console.error(e.error?.message||e.message),e.error?.message)}catch(a){return a instanceof Error?{error:a.message}:{error:"Login failed"}}};function L(){const o=g(),a=f(),[e,h]=d.useState({userEmail:"",userPassword:""}),[i,l]=d.useState({userEmail:"",userPassword:""}),c=t=>{const{id:u,value:r}=t.currentTarget;h(n=>({...n,[u]:r}))},p=async()=>{const t=E(e);if(l(t),Object.values(t).every(r=>r===""))try{const r=await b(e);if(r==="Invalid identifier or password"){l(n=>({...n,userEmail:"Invalid Emai or password"}));return}a(w(r.user.roleType)),r.user.roleType==="seller"?o("/dashboard"):r.user.roleType==="buyer"&&o("/")}catch(r){console.log(r)}};return s.jsx(s.Fragment,{children:s.jsx("div",{className:"global_container",children:s.jsxs("div",{className:x.auth_form,children:[s.jsx("h1",{children:"Welcome back"}),s.jsx(m,{id:"userEmail",label:"Email",type:"text",name:"userEmail",error:i.userEmail,placeholder:"Email",onChange:c}),s.jsx(m,{id:"userPassword",label:"Password",type:"password",name:"userPassword",error:i.userPassword,placeholder:"Password",onChange:c}),s.jsx("button",{onClick:p,children:"Login"}),s.jsx(y,{to:"signup"})]})})})}export{L as default};
