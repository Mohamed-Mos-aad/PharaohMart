import{f as g,h as f,r as d,j as e,k as w}from"./index-Bm52MoZb.js";import{S as E}from"./SwitchAuth-DrFCRQ0G.js";import{I as m}from"./InputElement-DNxHq9H2.js";import{a as x}from"./index-CR4Xcdnb.js";import{b as y,a as j}from"./axios.config-DecBwDMt.js";const I="_auth_form_17roa_3",v={auth_form:I},b=async a=>{try{const s=await P(a);return localStorage.setItem("token",s.jwt),localStorage.setItem("userData",JSON.stringify(s.user)),{success:!0,data:{user:s.user,jwt:s.jwt}}}catch(s){return console.error("[Login Error]:",s),y.isAxiosError(s)?{success:!1,error:{message:s.response?.data?.message||s.message,details:s.response?.data}}:{success:!1,error:{message:s instanceof Error?s.message:"Unknown error occurred",details:s}}}},P=async a=>{try{return(await j.post("/auth/local",{identifier:a.userEmail,password:a.userPassword})).data}catch(s){throw console.error("[Login Error]:",s),s}};function C(){const a=g(),s=f(),[n,p]=d.useState({userEmail:"",userPassword:""}),[c,i]=d.useState({userEmail:"",userPassword:""}),l=o=>{const{id:u,value:r}=o.currentTarget;p(t=>({...t,[u]:r}))},h=async()=>{const o=x(n);if(i(o),Object.values(o).every(r=>r===""))try{const r=await b(n);if(r.error?.message==="Invalid identifier or password"){i(t=>({...t,userEmail:"Invalid Emai or password"}));return}s(w(r.data?.user.roleType)),r.data?.user.roleType==="seller"?a("/dashboard"):r.data?.user.roleType==="customer"&&a("/")}catch(r){console.log(r)}};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"global_container",children:e.jsxs("div",{className:v.auth_form,children:[e.jsx("h1",{children:"Welcome back"}),e.jsx(m,{id:"userEmail",label:"Email",type:"text",name:"userEmail",error:c.userEmail,placeholder:"Email",onChange:l}),e.jsx(m,{id:"userPassword",label:"Password",type:"password",name:"userPassword",error:c.userPassword,placeholder:"Password",onChange:l}),e.jsx("button",{onClick:h,children:"Login"}),e.jsx(E,{to:"signup"})]})})})}export{C as default};
