import{j as e,r as m,u as F,g as M,a as $,b as A,c as V,d as Z}from"./index-mruIk9pB.js";import{u as D,a as k}from"./hooks-Bplr4AmI.js";import{T as E}from"./TextAreaInputElement-Dw9QuaYO.js";import{g as T}from"./productActions-B6xn1fsG.js";import{a as z}from"./index-NIGUFBhG.js";const B="_product_1nmwm_3",U="_product_data_1nmwm_15",O="_product_item_1nmwm_81",q="_product_item_photos_1nmwm_93",W="_product_photos_1nmwm_105",Y="_preview_1nmwm_145",J="_zoom_1nmwm_165",X="_product_details_1nmwm_183",G="_product_btns_1nmwm_261",K="_product_review_1nmwm_331",Q="_customers_reviews_1nmwm_347",ee="_add_review_1nmwm_359",te="_review_1nmwm_407",se="_user_review_1nmwm_419",re="_userPhoto_1nmwm_431",oe="_user_review_data_1nmwm_461",ne="_user_star_rate_1nmwm_485",ae="_review_btns_1nmwm_515",ce="_customers_rates_1nmwm_563",ie="_over_rate_1nmwm_563",de="_over_rate_stars_1nmwm_589",le="_all_rate_1nmwm_619",ue="_star_rate_1nmwm_631",me="_rate_bar_1nmwm_643",o={product:B,product_data:U,product_item:O,product_item_photos:q,product_photos:W,preview:Y,zoom:J,product_details:X,product_btns:G,product_review:K,customers_reviews:Q,add_review:ee,review:te,user_review:se,userPhoto:re,user_review_data:oe,user_star_rate:ne,review_btns:ae,customers_rates:ce,over_rate:ie,over_rate_stars:de,all_rate:le,star_rate:ue,rate_bar:me},he="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20class='icon%20icon-tabler%20icons-tabler-outline%20icon-tabler-send-2'%3e%3cpath%20stroke='none'%20d='M0%200h24v24H0z'%20fill='none'/%3e%3cpath%20d='M4.698%204.034l16.302%207.966l-16.302%207.966a.503%20.503%200%200%201%20-.546%20-.124a.555%20.555%200%200%201%20-.12%20-.568l2.468%20-7.274l-2.468%20-7.274a.555%20.555%200%200%201%20.12%20-.568a.503%20.503%200%200%201%20.546%20-.124z'%20/%3e%3cpath%20d='M6.5%2012h14.5'%20/%3e%3c/svg%3e";function _e({name:s,category:r,seller:d}){return e.jsx(e.Fragment,{children:e.jsxs("div",{className:o.product_data,children:[e.jsxs("h3",{children:["Home ",e.jsx("span",{children:"/"})," ",e.jsx("div",{children:r})]}),e.jsx("h2",{children:s}),e.jsx("h4",{children:d})]})})}function pe({productThumbnail:s,productPhotos:r,productDescription:d,productPrice:u,productDiscount:h,productOff:_,addToCartHandler:t,removeProductFromCartHandler:j,addToFavouriteHandler:c,removeFromFavouriteHandler:v,addedToWishList:x,addedToCart:i}){const[p,w]=m.useState(s.src),[C,f]=m.useState(!1),[g,L]=m.useState({x:0,y:0}),N=l=>{w(l.url)},I=l=>{const n=l.currentTarget.getBoundingClientRect(),a=(l.clientX-n.left)/n.width*100,b=(l.clientY-n.top)/n.height*100;L({x:a,y:b})},P=r.map(l=>e.jsx("span",{onClick:()=>{N(l)},children:e.jsx("img",{src:l.url,alt:d})},`${l.name}`));return m.useEffect(()=>{w(s.src)},[s]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:o.product_item,children:[e.jsxs("div",{className:o.product_item_photos,children:[e.jsx("div",{className:o.product_photos,children:P}),e.jsx("div",{className:o.preview,style:{backgroundImage:`url(${p})`},onMouseMove:I,onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),children:C&&e.jsx("div",{className:o.zoom,style:{left:`calc(${g.x}% - 100px)`,top:`calc(${g.y}% - 100px)`,backgroundImage:`url(${p})`,backgroundPosition:`${g.x}% ${g.y}%`}})})]}),e.jsxs("div",{className:o.product_details,children:[e.jsx("h2",{children:"Product Details"}),e.jsx("p",{children:d}),e.jsxs("h3",{children:["$",u,e.jsx("span",{children:_}),e.jsxs("span",{children:[h,"Off"]})]}),e.jsxs("div",{className:o.product_btns,children:[i?e.jsx("button",{onClick:j,children:"Remove from Cart"}):e.jsx("button",{onClick:t,children:"Add to Cart"}),e.jsx("button",{children:"Buy Now"})]}),x?e.jsx("button",{onClick:v,children:"remove from Wishlist"}):e.jsx("button",{onClick:c,children:"Add to Wishlist"})]})]})})}const y="data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M15.4883%207.04234L12.3172%209.80984L13.2671%2013.9302C13.3699%2014.3705%2013.199%2014.8296%2012.8333%2015.0956C12.4676%2015.3616%2011.9782%2015.3828%2011.5909%2015.1494L7.99719%2012.9697L4.41125%2015.1494C4.02394%2015.3828%203.53452%2015.3616%203.16882%2015.0956C2.80312%2014.8296%202.63223%2014.3705%202.735%2013.9302L3.68352%209.81406L0.511719%207.04234C0.168718%206.74652%200.0365809%206.27384%200.176449%205.84303C0.316317%205.41222%200.700908%205.1073%201.15227%205.06938L5.33305%204.70727L6.965%200.814766C7.13926%200.397124%207.54746%200.12514%208%200.12514C8.45254%200.12514%208.86074%200.397124%209.035%200.814766L10.6719%204.70727L14.8512%205.06938C15.3026%205.1073%2015.6872%205.41222%2015.8271%205.84303C15.9669%206.27384%2015.8348%206.74652%2015.4918%207.04234H15.4883Z'%20fill='%23C78F00'/%3e%3c/svg%3e",H="data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M15.8188%205.8407C15.6795%205.41148%2015.2972%205.107%2014.8477%205.06727L10.6719%204.70727L9.035%200.814766C8.86074%200.397124%208.45254%200.12514%208%200.12514C7.54746%200.12514%207.13926%200.397124%206.965%200.814766L5.33305%204.70727L1.15227%205.06938C0.700908%205.1073%200.316317%205.41222%200.176449%205.84303C0.0365809%206.27384%200.168718%206.74652%200.511719%207.04234L3.68352%209.81406L2.73289%2013.9302C2.63012%2014.3705%202.80102%2014.8296%203.16672%2015.0956C3.53241%2015.3616%204.02183%2015.3828%204.40914%2015.1494L7.99508%2012.9697L11.5887%2015.1494C11.9761%2015.3828%2012.4655%2015.3616%2012.8312%2015.0956C13.1969%2014.8296%2013.3678%2014.3705%2013.265%2013.9302L12.3151%209.80984L15.4862%207.04234C15.8292%206.74548%2015.9603%206.27167%2015.8188%205.8407ZM14.7486%206.19227L11.5775%208.95977C11.263%209.23335%2011.1255%209.65843%2011.2203%2010.0644L12.173%2014.1875L8.58219%2012.0078C8.22504%2011.7903%207.77637%2011.7903%207.41922%2012.0078L3.83328%2014.1875L4.77969%2010.0672C4.87447%209.66124%204.73702%209.23617%204.4225%208.96258L1.25%206.19648C1.24974%206.19438%201.24974%206.19226%201.25%206.19016L5.42938%205.82875C5.84523%205.7921%206.20659%205.52818%206.36805%205.1432L8%201.25563L9.63125%205.1432C9.79271%205.52818%2010.1541%205.7921%2010.5699%205.82875L14.75%206.19016C14.75%206.19016%2014.75%206.19437%2014.75%206.19508L14.7486%206.19227Z'%20fill='%23C78F00'/%3e%3c/svg%3e",ve="data:image/svg+xml,%3csvg%20width='18'%20height='16'%20viewBox='0%200%2018%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M17.2812%205.25938C16.9252%204.85594%2016.4131%204.62489%2015.875%204.625H11.5V3.375C11.5%201.64911%2010.1009%200.25%208.375%200.25C8.13818%200.24983%207.9216%200.383527%207.81563%200.595312L4.86406%206.5H1.5C0.809644%206.5%200.25%207.05964%200.25%207.75V14.625C0.25%2015.3154%200.809644%2015.875%201.5%2015.875H14.9375C15.8827%2015.8753%2016.6803%2015.1721%2016.7984%2014.2344L17.7359%206.73438C17.8032%206.20023%2017.6375%205.66297%2017.2812%205.25938ZM1.5%207.75H4.625V14.625H1.5V7.75ZM16.4953%206.57812L15.5578%2014.0781C15.5184%2014.3907%2015.2526%2014.6251%2014.9375%2014.625H5.875V7.27266L8.74297%201.53594C9.61946%201.71136%2010.2502%202.48112%2010.25%203.375V5.25C10.25%205.59518%2010.5298%205.875%2010.875%205.875H15.875C16.0544%205.87494%2016.2252%205.95198%2016.3439%206.08652C16.4626%206.22106%2016.5177%206.40012%2016.4953%206.57812Z'%20fill='%23A18745'/%3e%3c/svg%3e",xe="data:image/svg+xml,%3csvg%20width='18'%20height='16'%20viewBox='0%200%2018%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M17.7359%209.26562L16.7984%201.76562C16.6803%200.827882%2015.8827%200.124676%2014.9375%200.125H1.5C0.809644%200.125%200.25%200.684644%200.25%201.375V8.25C0.25%208.94036%200.809644%209.5%201.5%209.5H4.86406L7.81563%2015.4047C7.9216%2015.6165%208.13818%2015.7502%208.375%2015.75C10.1009%2015.75%2011.5%2014.3509%2011.5%2012.625V11.375H15.875C16.4132%2011.3752%2016.9256%2011.1441%2017.2817%2010.7404C17.6378%2010.3368%2017.8032%209.79964%2017.7359%209.26562ZM4.625%208.25H1.5V1.375H4.625V8.25ZM16.3438%209.91328C16.2259%2010.0489%2016.0547%2010.1262%2015.875%2010.125H10.875C10.5298%2010.125%2010.25%2010.4048%2010.25%2010.75V12.625C10.2502%2013.5189%209.61946%2014.2886%208.74297%2014.4641L5.875%208.72734V1.375H14.9375C15.2526%201.37489%2015.5184%201.60929%2015.5578%201.92188L16.4953%209.42188C16.519%209.59995%2016.4636%209.77949%2016.3438%209.91328Z'%20fill='%23A18745'/%3e%3c/svg%3e";function we({userData:s,userRate:r,userComment:d,UserSupport:u}){const h=Array.from({length:5},(_,t)=>t<r?e.jsx("img",{src:y,alt:"star icon"},t):e.jsx("img",{src:H,alt:"unStar icon"},t));return e.jsx(e.Fragment,{children:e.jsxs("div",{className:o.review,children:[e.jsxs("div",{className:o.user_review,children:[e.jsx("div",{className:o.userPhoto,children:s.userPhoto.url?e.jsx("img",{src:s.userPhoto.url,alt:s.userPhoto.name}):e.jsx("div",{children:s.userName[0]})}),e.jsxs("div",{className:o.user_review_data,children:[e.jsx("h3",{children:s.userName}),e.jsx("h5",{children:s.date})]})]}),e.jsx("div",{className:o.user_star_rate,children:h}),e.jsx("p",{children:d}),e.jsxs("div",{className:o.review_btns,children:[e.jsxs("button",{children:[e.jsx("img",{src:ve,alt:"like icon"}),e.jsx("span",{children:u.like})]}),e.jsxs("button",{children:[e.jsx("img",{src:xe,alt:"unLike icon"}),e.jsx("span",{children:u.like})]})]})]})})}function ge({reviews:s}){const r=s.length,d=s.filter(i=>i.userRate===1).length,u=s.filter(i=>i.userRate===2).length,h=s.filter(i=>i.userRate===3).length,_=s.filter(i=>i.userRate===4).length,t=s.filter(i=>i.userRate===5).length,j=d*1+u*2+h*3+_*4+t*5,c={one:r>0?d/r*100:0,two:r>0?u/r*100:0,three:r>0?h/r*100:0,four:r>0?_/r*100:0,five:r>0?t/r*100:0},v=r>0?j/r:0,x=Array.from({length:5},(i,p)=>{const w=Math.round(v*2)/2;return p<Math.floor(w)?e.jsx("img",{src:y,alt:"star icon"},p):e.jsx("img",{src:H,alt:"unStar icon"},p)});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:o.over_rate,children:[e.jsx("h2",{children:v.toFixed(1)}),e.jsx("div",{className:o.over_rate_stars,children:x}),e.jsxs("h3",{children:[r," reviews"]})]}),e.jsxs("div",{className:o.all_rate,children:[e.jsxs("div",{className:o.star_rate,children:["5",e.jsx("div",{className:o.rate_bar,children:e.jsx("span",{style:{width:`${c.five}%`}})}),e.jsxs("span",{children:[c.five.toFixed(1),"%"]})]}),e.jsxs("div",{className:o.star_rate,children:["4",e.jsx("div",{className:o.rate_bar,children:e.jsx("span",{style:{width:`${c.four}%`}})}),e.jsxs("span",{children:[c.four.toFixed(1),"%"]})]}),e.jsxs("div",{className:o.star_rate,children:["3",e.jsx("div",{className:o.rate_bar,children:e.jsx("span",{style:{width:`${c.three}%`}})}),e.jsxs("span",{children:[c.three.toFixed(1),"%"]})]}),e.jsxs("div",{className:o.star_rate,children:["2",e.jsx("div",{className:o.rate_bar,children:e.jsx("span",{style:{width:`${c.two}%`}})}),e.jsxs("span",{children:[c.two.toFixed(1),"%"]})]}),e.jsxs("div",{className:o.star_rate,children:["1",e.jsx("div",{className:o.rate_bar,children:e.jsx("span",{style:{width:`${c.one}%`}})}),e.jsxs("span",{children:[c.one.toFixed(1),"%"]})]})]})]})}const je="http://localhost:1337",R=localStorage.getItem("token"),S=z.create({baseURL:`${je}/api/`,headers:R?{Authorization:`Bearer ${R}`}:{}}),fe=async s=>{try{return(await S.post("/reviews",{data:s})).data.data}catch(r){throw console.error("Error Response:",r),r}},Ce=async s=>{try{return(await S.get(`/products/${s}?populate[reviews][populate]=user`)).data.data.reviews}catch(r){throw console.error(`Error fetching product with id ${s}:`,r),r}},Le=s=>new Date(s).toISOString().split("T")[0];function Re(){const{id:s}=F(),r=D(),d=k(n=>n.cart),u=k(n=>n.favourite),h=M(),_=JSON.parse(localStorage.getItem("userData")||"null"),[t,j]=m.useState(),c=!!_,[v,x]=m.useState({user:c?_.id:"",product:t?.documentId??"",userComment:"",like:0,unLike:0,userRate:0}),[i,p]=m.useState([]),w=()=>{if(!t)return;d.products.some(a=>a.productId===t.documentId)||r($({productId:t.documentId,name:t.name,sellerName:t.name,quantity:1,price:t.price,imageUrl:t.mainImage.url}))},C=()=>{if(!t)return;d.products.some(a=>a.productId===t.documentId)&&r(A({productId:t.documentId,name:t.name,sellerName:t.name,quantity:1,price:t.price,imageUrl:t.mainImage.url}))},f=()=>t?d.products.some(a=>a.productId===t.documentId):!1,g=()=>{if(!t)return;u.products.some(a=>a.productId===t.documentId)||r(V({productId:t.documentId,name:t.name,sellerName:t.name,quantity:1,price:t.price,imageUrl:t.mainImage.url}))},L=()=>{if(!t)return;u.products.some(a=>a.productId===t.documentId)&&r(Z({productId:t.documentId,name:t.name,sellerName:t.name,quantity:1,price:t.price,imageUrl:t.mainImage.url}))},N=()=>t?h.favourite.products.some(a=>a.productId===t.documentId):!1,I=n=>{const{value:a}=n.currentTarget;x(b=>({...b,userComment:a}))},P=async()=>{try{if(!t&&!c)return;console.log("notwork"),await fe(v),x(n=>({...n,userComment:""}))}catch(n){console.log(n)}},l=i.map(n=>e.jsx(we,{userData:{userPhoto:n.user.logo??"",userName:n.user.username,date:Le(n.publishedAt)},userRate:n.userRate,userComment:n.userComment,UserSupport:{like:n.like,unLike:n.unLike}},n.documentId));return m.useEffect(()=>{(async()=>{try{if(s){const a=await T(s);j(a)}}catch(a){console.log(a)}})()},[s]),m.useEffect(()=>{t&&((async()=>{try{if(s){const a=await Ce(s);p(a)}}catch(a){console.log(a)}})(),x(a=>({...a,product:t.documentId})))},[t,s]),t?e.jsx(e.Fragment,{children:e.jsx("div",{className:"global_container",children:e.jsxs("div",{className:o.product,children:[e.jsx(_e,{name:t?.name,category:t.categories[0].title,seller:t.owner.storeName}),e.jsx(pe,{productThumbnail:{src:t.mainImage.url,alt:t.name},productPhotos:t.images,productDescription:t.description,productPrice:t?.price||0,productDiscount:"",productOff:"",addToCartHandler:w,addToFavouriteHandler:g,removeFromFavouriteHandler:L,removeProductFromCartHandler:C,addedToWishList:N(),addedToCart:f()}),e.jsxs("div",{className:o.product_review,children:[e.jsxs("div",{className:o.customers_reviews,children:[e.jsxs("div",{className:o.add_review,children:[e.jsx(E,{id:"review",label:"Review",name:"review",placeholder:"Enter Your Review",value:v.userComment||"",onChange:I}),e.jsx("button",{onClick:P,children:e.jsx("img",{src:he,alt:"send button"})})]}),l]}),e.jsx("div",{className:o.customers_rates,children:e.jsx(ge,{reviews:t?.reviews})})]})]})})}):e.jsx(e.Fragment,{})}export{Re as default};
