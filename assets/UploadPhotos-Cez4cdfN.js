import{r as g,j as e}from"./index-mruIk9pB.js";import{a as I}from"./index-NIGUFBhG.js";const P="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M16%208L8%2016M16%2016L8%208'%20stroke='black'%20stroke-width='2'%20stroke-linecap='round'/%3e%3c/svg%3e",U="_upload_images_1w8r3_3",A="_title_1w8r3_29",E="_uploaded_images_1w8r3_85",N="_product_photo_1w8r3_97",i={upload_images:U,title:A,uploaded_images:E,product_photo:N},$="http://localhost:1337",b=localStorage.getItem("token"),j=I.create({baseURL:`${$}/api/`,headers:{Authorization:`Bearer ${b}`}}),w=async t=>{try{const s=new FormData;return s.append("files",t),(await j.post("/upload",s)).data[0]}catch(s){throw console.error("Error uploading photo:",s),s}},L=async t=>{try{await j.delete(`/upload/files/${t}`)}catch(s){throw console.error("Error uploading photo:",s),s}};function B({quantity:t,title:s,description:u,onUpload:f}){const[a,d]=g.useState([]),[c,_]=g.useState(!1),v=async o=>{o.preventDefault();const n=Array.from(o.dataTransfer.files).filter(r=>r.type==="image/jpeg"||r.type==="image/png");if(n.length>0){for(const r of n)if(a.length<t){const p=await w(r);d(h=>[...h,p])}}},y=o=>{o.preventDefault()},F=async o=>{if(c)return;const l=o.target.files;if(l){const n=Array.from(l).filter(r=>r.type==="image/jpeg"||r.type==="image/png");for(const r of n)if(a.length<t){const p=await w(r);d(h=>{const x=[...h,p];if(f){const C=x.map(m=>m.id).filter(m=>m!==void 0);f(C)}return x})}}},D=async o=>{d(l=>l.filter(n=>n.id!==o)),await L(o)},k=a.map((o,l)=>e.jsxs("div",{className:i.product_photo,children:[e.jsx("img",{src:o.url,alt:"product photo"}),e.jsx("span",{onClick:()=>{D(o.id)},children:e.jsx("img",{src:P,alt:"delete Icon"})})]},o.name+l));return g.useEffect(()=>{a.length===t?_(!0):a.length<t+1&&_(!1)},[a,t]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:i.upload_images,onDrop:v,onDragOver:y,style:c?{cursor:"no-drop"}:{cursor:"default"},children:[a.length<1?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:i.title,children:s}),e.jsx("p",{children:u})]}):e.jsx("div",{className:i.uploaded_images,style:{gridTemplateColumns:`repeat(${t},1fr)`},children:k}),e.jsx("label",{htmlFor:"uploadPhoto",style:c?{cursor:"no-drop"}:{cursor:"pointer"},children:"Upload"}),e.jsx("input",{type:"file",name:"",id:"uploadPhoto",hidden:!0,multiple:t>1,onChange:F})]})})}export{B as U};
